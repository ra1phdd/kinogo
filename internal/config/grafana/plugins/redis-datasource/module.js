/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","@emotion/css","rxjs"],(function(e,t,n,a,r,i){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=6)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t,n){"use strict";n.r(t);var a=n(2),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function l(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}s((a=a.apply(e,t||[])).next())}))}function s(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}Object.create;function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function u(e,t,n){if(n||2===arguments.length)for(var a,r=0,i=t.length;r<i;r++)!a&&r in t||(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function d(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}Object.create;var p,h=n(0),f=n.n(h),m=n(1);!function(e){e.CLUSTER="cluster",e.SENTINEL="sentinel",e.SOCKET="socket",e.STANDALONE="standalone"}(p||(p={}));var v,g=[{label:"Standalone",value:p.STANDALONE},{label:"Cluster",value:p.CLUSTER},{label:"Sentinel",value:p.SENTINEL},{label:"Socket",value:p.SOCKET}];!function(e){e.TIMESERIES="TimeSeries",e.DATAFRAME="DataFrame"}(v||(v={}));var b,E=[{label:"Time series",value:v.TIMESERIES},{label:"Data frame",value:v.DATAFRAME}],y=m.LegacyForms.SecretFormField,C=m.LegacyForms.FormField,S=m.LegacyForms.Switch,N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPoolSizeChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{jsonData:o(o({},r.jsonData),{poolSize:Number(e.target.value)})}))},t.onTimeoutChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{jsonData:o(o({},r.jsonData),{timeout:Number(e.target.value)})}))},t.onPingIntervalChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{jsonData:o(o({},r.jsonData),{pingInterval:Number(e.target.value)})}))},t.onPipelineWindowChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{jsonData:o(o({},r.jsonData),{pipelineWindow:Number(e.target.value)})}))},t.onPasswordChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{secureJsonData:o(o({},r.secureJsonData),{password:e.target.value})}))},t.onSentinelPasswordChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{secureJsonData:o(o({},r.secureJsonData),{sentinelPassword:e.target.value})}))},t.onResetPassword=function(){var e=t.props,n=e.onOptionsChange,a=e.options;n(o(o({},a),{secureJsonFields:o(o({},a.secureJsonFields),{password:!1}),secureJsonData:o(o({},a.secureJsonData),{password:""})}))},t.onSentinelResetPassword=function(){var e=t.props,n=e.onOptionsChange,a=e.options;n(o(o({},a),{secureJsonFields:o(o({},a.secureJsonFields),{sentinelPassword:!1}),secureJsonData:o(o({},a.secureJsonData),{sentinelPassword:""})}))},t.onTlsClientCertificateChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{secureJsonData:o(o({},r.secureJsonData),{tlsClientCert:e.currentTarget.value})}))},t.onResetTlsClientCertificate=function(){var e=t.props,n=e.onOptionsChange,a=e.options;n(o(o({},a),{secureJsonFields:o(o({},a.secureJsonFields),{tlsClientCert:!1}),secureJsonData:o(o({},a.secureJsonData),{tlsClientCert:""})}))},t.onTlsCACertificateChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{secureJsonData:o(o({},r.secureJsonData),{tlsCACert:e.currentTarget.value})}))},t.onResetTlsCACertificate=function(){var e=t.props,n=e.onOptionsChange,a=e.options;n(o(o({},a),{secureJsonFields:o(o({},a.secureJsonFields),{tlsCACert:!1}),secureJsonData:o(o({},a.secureJsonData),{tlsCACert:""})}))},t.onTlsClientKeyChange=function(e){var n=t.props,a=n.onOptionsChange,r=n.options;a(o(o({},r),{secureJsonData:o(o({},r.secureJsonData),{tlsClientKey:e.currentTarget.value})}))},t.onResetTlsClientKey=function(){var e=t.props,n=e.onOptionsChange,a=e.options;n(o(o({},a),{secureJsonFields:o(o({},a.secureJsonFields),{tlsClientKey:!1}),secureJsonData:o(o({},a.secureJsonData),{tlsClientKey:""})}))},t}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.options,n=e.onOptionsChange,a=t.url,r=t.jsonData,i=t.secureJsonFields,l=t.secureJsonData||{};return f.a.createElement("div",{className:"gf-form-group"},f.a.createElement("h3",{className:"page-heading"},"Redis"),f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:10,tooltip:"Redis accepts clients connections on the configured listening TCP port and on the Unix socket if enabled.\n            Cluster is a distributed implementation of OSS Redis. Sentinel provides high availability."},"Type"),f.a.createElement(m.RadioButtonGroup,{options:g,value:r.client||p.STANDALONE,onChange:function(e){var a=o(o({},t.jsonData),{client:e});n(o(o({},t),{jsonData:a}))}})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(C,{label:"Address",labelWidth:10,inputWidth:20,onChange:function(e){n(o(o({},t),{url:e.target.value}))},value:a||"",tooltip:"Accepts host:port address or a URI, as defined in https://www.iana.org/assignments/uri-schemes/prov/redis.\n            For Redis Cluster and Sentinel can contain multiple values with comma.\n            For a Unix Socket accepts path to socket file.",placeholder:"redis://..."})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(S,{label:"ACL",labelClass:"width-10",tooltip:"Allows certain connections to be limited in terms of the commands that can be executed and the keys that can be accessed",checked:r.acl||!1,onChange:function(e){var a=o(o({},t.jsonData),{acl:e.currentTarget.checked});n(o(o({},t),{jsonData:a}))}}),r.acl&&f.a.createElement(C,{label:"Username",labelWidth:10,inputWidth:10,value:r.user,tooltip:"Provide ACL Username to authenticate.",onChange:function(e){n(o(o({},t),{jsonData:o(o({},t.jsonData),{user:e.target.value})}))}})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(y,{isConfigured:i&&i.password,value:l.password||"",label:"Password",placeholder:"Database password",labelWidth:10,inputWidth:20,tooltip:"When specified AUTH command will be used to authenticate with the provided password.",onReset:this.onResetPassword,onChange:this.onPasswordChange})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(C,{label:"Pool Size",labelWidth:10,inputWidth:10,onChange:this.onPoolSizeChange,value:r.poolSize,placeholder:"5",tooltip:"Will keep open at least the given number of connections to the redis instance at the given address.\n            The recommended size of the pool depends on the number of concurrent goroutines that will use the pool and\n            whether implicit pipelining is enabled or not."})),r.client===p.SENTINEL&&f.a.createElement(f.a.Fragment,null,f.a.createElement("br",null),f.a.createElement("h3",{className:"page-heading"},"Sentinel"),f.a.createElement("div",{className:"gf-form"},f.a.createElement(C,{label:"Master Name",labelWidth:10,inputWidth:10,value:r.sentinelName,tooltip:"Provide Master Name to connect to.",onChange:function(e){n(o(o({},t),{jsonData:o(o({},t.jsonData),{sentinelName:e.target.value})}))}})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(S,{label:"Sentinel ACL",labelClass:"width-10",tooltip:"Allows certain connections to be limited in terms of the commands that can be executed and the keys that can be accessed",checked:r.sentinelAcl||!1,onChange:function(e){var a=o(o({},t.jsonData),{sentinelAcl:e.currentTarget.checked});n(o(o({},t),{jsonData:a}))}}),r.sentinelAcl&&f.a.createElement(C,{label:"Sentinel Username",labelWidth:10,inputWidth:10,value:r.sentinelUser,tooltip:"Provide ACL Username to authenticate.",onChange:function(e){n(o(o({},t),{jsonData:o(o({},t.jsonData),{sentinelUser:e.target.value})}))}})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(y,{isConfigured:i&&i.sentinelPassword,value:l.sentinelPassword||"",label:"Sentinel Password",placeholder:"Sentinel password",labelWidth:10,inputWidth:20,tooltip:"When specified AUTH command will be used to authenticate with the provided password.",onReset:this.onSentinelResetPassword,onChange:this.onSentinelPasswordChange}))),f.a.createElement("br",null),f.a.createElement("h3",{className:"page-heading"},"Advanced settings"),f.a.createElement("div",{className:"gf-form"},f.a.createElement(C,{label:"Timeout, sec",labelWidth:10,inputWidth:10,onChange:this.onTimeoutChange,value:r.timeout,placeholder:"10",tooltip:"Sets the duration in seconds for connect, read and write timeouts."}),f.a.createElement(C,{label:"Ping Interval, sec",labelWidth:10,inputWidth:10,onChange:this.onPingIntervalChange,value:r.pingInterval,placeholder:"0",tooltip:"Specifies the interval in seconds at which a ping event happens.\n            A shorter interval means connections are pinged more frequently, but also means more traffic with the server.\n            If interval is zero then ping will be disabled."})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(C,{label:"Pipeline Window, Î¼s",labelWidth:10,inputWidth:10,onChange:this.onPipelineWindowChange,value:r.pipelineWindow,placeholder:"0",tooltip:"Sets the duration in microseconds after which internal pipelines will be flushed.\n            If window is zero then implicit pipelining will be disabled."}),f.a.createElement(S,{label:"Disable CLI",labelClass:"width-10",tooltip:"Disable Command-Line interface in the Query Editor",checked:r.cliDisabled||!1,onChange:function(e){var a=o(o({},t.jsonData),{cliDisabled:e.currentTarget.checked});n(o(o({},t),{jsonData:a}))}})),f.a.createElement("br",null),f.a.createElement("h3",{className:"page-heading"},"TLS"),f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement(S,{label:"Client Authentication",labelClass:"width-10",checked:r.tlsAuth||!1,onChange:function(e){var a=o(o({},t.jsonData),{tlsAuth:e.currentTarget.checked});n(o(o({},t),{jsonData:a}))}}),r.tlsAuth&&f.a.createElement(S,{label:"Skip Verify",labelClass:"width-10",tooltip:"If checked, the server's certificate will not be checked for validity.",checked:r.tlsSkipVerify||!1,onChange:function(e){var a=o(o({},t.jsonData),{tlsSkipVerify:e.currentTarget.checked});n(o(o({},t),{jsonData:a}))}})),r.tlsAuth&&f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement("div",{className:"gf-form gf-form--v-stretch"},f.a.createElement("label",{className:"gf-form-label width-10"},"Client Certificate")),i&&i.tlsClientCert?f.a.createElement(m.Button,{type:"reset",variant:"secondary",onClick:this.onResetTlsClientCertificate},"Reset"):f.a.createElement("div",{className:"gf-form gf-form--grow"},f.a.createElement(m.TextArea,{rows:7,className:"gf-form-input gf-form-textarea",placeholder:"Begins with -----BEGIN CERTIFICATE-----",onChange:this.onTlsClientCertificateChange}))),f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement("div",{className:"gf-form gf-form--v-stretch"},f.a.createElement("label",{className:"gf-form-label width-10"},"Client Key")),f.a.createElement("div",{className:"gf-form gf-form--grow"},i&&i.tlsClientKey?f.a.createElement(m.Button,{type:"reset",variant:"secondary",onClick:this.onResetTlsClientKey},"Reset"):f.a.createElement(m.TextArea,{rows:7,className:"gf-form-input gf-form-textarea",placeholder:"Begins with -----BEGIN PRIVATE KEY-----",onChange:this.onTlsClientKeyChange}))),f.a.createElement("div",{className:"gf-form-inline"},f.a.createElement("div",{className:"gf-form gf-form--v-stretch"},f.a.createElement("label",{className:"gf-form-label width-10"},"Certification Authority")),i&&i.tlsCACert?f.a.createElement(m.Button,{type:"reset",variant:"secondary",onClick:this.onResetTlsCACertificate},"Reset"):f.a.createElement("div",{className:"gf-form gf-form--grow"},f.a.createElement(m.TextArea,{rows:7,className:"gf-form-input gf-form-textarea",placeholder:"Begins with -----BEGIN CERTIFICATE-----",onChange:this.onTlsCACertificateChange})))))},t}(h.PureComponent),T=n(4),R=n(3);!function(e){e.DUMPREGISTRATIONS="rg.dumpregistrations",e.PYSTATS="rg.pystats",e.PYDUMPREQS="rg.pydumpreqs",e.PYEXECUTE="rg.pyexecute"}(b||(b={}));var A,w=[{label:b.DUMPREGISTRATIONS.toUpperCase(),description:"Outputs the list of function registrations",value:b.DUMPREGISTRATIONS},{label:b.PYDUMPREQS.toUpperCase(),description:"Returns a list of all the python requirements available",value:b.PYDUMPREQS},{label:b.PYEXECUTE.toUpperCase(),description:"Executes Python functions and registers functions for event-driven processing",value:b.PYEXECUTE},{label:b.PYSTATS.toUpperCase(),description:"Returns memory usage statistics from the Python interpreter",value:b.PYSTATS}];!function(e){e.CONFIG="graph.config",e.PROFILE="graph.profile",e.EXPLAIN="graph.explain",e.QUERY="graph.query",e.SLOWLOG="graph.slowlog"}(A||(A={}));var I,F=[{label:A.CONFIG.toUpperCase(),description:"Retrieves a RedisGraph configuration",value:A.CONFIG},{label:A.EXPLAIN.toUpperCase(),description:"Constructs a query execution plan but does not run it",value:A.EXPLAIN},{label:A.PROFILE.toUpperCase(),description:"Executes a query and produces an execution plan augmented with metrics for each operation's execution",value:A.PROFILE},{label:A.QUERY.toUpperCase(),description:"Executes the given query against a specified graph",value:A.QUERY},{label:A.SLOWLOG.toUpperCase(),description:"Returns a list containing up to 10 of the slowest queries issued against the given graph ID",value:A.SLOWLOG}];!function(e){e.OBJKEYS="json.objkeys",e.OBJLEN="json.objlen",e.GET="json.get",e.TYPE="json.type",e.ARRLEN="json.arrlen"}(I||(I={}));var O,L=[{label:I.ARRLEN.toUpperCase(),description:"Report the length of the JSON Array at path in key",value:I.ARRLEN},{label:I.GET.toUpperCase(),description:"Return the value at path",value:I.GET},{label:I.OBJKEYS.toUpperCase(),description:"Return the keys in the object that's referenced by path",value:I.OBJKEYS},{label:I.OBJLEN.toUpperCase(),description:"Report the number of keys in the JSON Object at path in key",value:I.OBJLEN},{label:I.TYPE.toUpperCase(),description:"Report the type of JSON value at path",value:I.TYPE}];!function(e){e.REDIS="command",e.TIMESERIES="timeSeries",e.SEARCH="search",e.CLI="cli",e.GEARS="gears",e.GRAPH="graph",e.JSON="json"}(O||(O={}));var P,x=[{label:"Redis",description:"Hashes, Sets, Lists, Strings, Streams, etc.",value:O.REDIS},{label:"RedisGears",description:"Dynamic framework for data processing",value:O.GEARS},{label:"RedisJSON",description:"JSON data type for Redis",value:O.JSON},{label:"RedisGraph",description:"Graph database",value:O.GRAPH},{label:"RediSearch",description:"Secondary Index & Query Engine",value:O.SEARCH},{label:"RedisTimeSeries",description:"Time Series data structure",value:O.TIMESERIES}],D={label:"Command-line interface (CLI)",description:"Be mindful, not all commands are supported",value:O.CLI};!function(e){e.CLIENT_LIST="clientList",e.CLUSTER_INFO="clusterInfo",e.CLUSTER_NODES="clusterNodes",e.GET="get",e.HGET="hget",e.HGETALL="hgetall",e.HKEYS="hkeys",e.HLEN="hlen",e.HMGET="hmget",e.INFO="info",e.LLEN="llen",e.TMSCAN="tmscan",e.SCARD="scard",e.SLOWLOG_GET="slowlogGet",e.SMEMBERS="smembers",e.TTL="ttl",e.TYPE="type",e.ZRANGE="zrange",e.XINFO_STREAM="xinfoStream",e.XLEN="xlen",e.XRANGE="xrange",e.XREVRANGE="xrevrange"}(P||(P={}));var G,M=[{label:"CLIENT LIST",description:"Returns information and statistics about the client connections server",value:P.CLIENT_LIST},{label:"CLUSTER INFO",description:"Provides INFO style information about Redis Cluster vital parameters",value:P.CLUSTER_INFO},{label:"CLUSTER NODES",description:"Provides current cluster configuration, given by the set of known nodes",value:P.CLUSTER_NODES},{label:P.GET.toUpperCase(),description:"Returns the value of key",value:P.GET},{label:P.HGET.toUpperCase(),description:"Returns the value associated with field in the hash stored at key",value:P.HGET},{label:P.HGETALL.toUpperCase(),description:"Returns all fields and values of the hash stored at key",value:P.HGETALL},{label:P.HKEYS.toUpperCase(),description:"Returns all field names in the hash stored at key",value:P.HKEYS},{label:P.HLEN.toUpperCase(),description:"Returns the number of fields contained in the hash stored at key",value:P.HLEN},{label:P.HMGET.toUpperCase(),description:"Returns the values associated with the specified fields in the hash stored at key",value:P.HMGET},{label:P.INFO.toUpperCase(),description:"Returns information and statistics about the server",value:P.INFO},{label:P.LLEN.toUpperCase(),description:"Returns the length of the list stored at key",value:P.LLEN},{label:P.TMSCAN.toUpperCase(),description:"Returns keys with types and memory usage (CAUSE LATENCY)",value:P.TMSCAN},{label:P.SCARD.toUpperCase(),description:"Returns the set cardinality (number of elements) of the set stored at key",value:P.SCARD},{label:"SLOWLOG GET",description:"Returns the Redis slow queries log",value:P.SLOWLOG_GET},{label:P.SMEMBERS.toUpperCase(),description:"Returns all the members of the set value stored at key",value:P.SMEMBERS},{label:P.TTL.toUpperCase(),description:"Returns the string representation of the type of the value stored at key",value:P.TTL},{label:P.TYPE.toUpperCase(),description:"Returns the string representation of the type of the value stored at key",value:P.TYPE},{label:P.ZRANGE.toUpperCase(),description:"Returns the specified range of elements in the sorted set at key",value:P.ZRANGE},{label:"XINFO STREAM",description:"Returns general information about the stream stored at the specified key",value:P.XINFO_STREAM},{label:P.XLEN.toUpperCase(),description:"Returns the number of entries inside a stream",value:P.XLEN},{label:P.XRANGE.toUpperCase(),description:"Returns the stream entries matching a given range of IDs",value:P.XRANGE},{label:P.XREVRANGE.toUpperCase(),description:"Returns the stream entries matching a given range of IDs in reverse order",value:P.XREVRANGE}];!function(e){e.BYINDEX="",e.BYSCORE="BYSCORE",e.BYLEX="BYLEX"}(G||(G={}));var U,k,H=[{label:"Index range",description:"The <min> and <max> arguments represent zero-based indexes, where 0 is the first element, 1 is the next element, and so on.",value:G.BYINDEX},{label:"Score range",description:"Returns the range of elements from the sorted set having scores equal or between <min> and <max>",value:G.BYSCORE}];!function(e){e.INFO="ft.info",e.SEARCH="ft.search"}(U||(U={})),function(e){e.NONE="None",e.ASC="ASC",e.DESC="DESC"}(k||(k={}));var W,j=[{label:U.INFO.toUpperCase(),description:"Returns information and statistics on the index",value:U.INFO},{label:U.SEARCH.toUpperCase(),description:"Search the index with a textual query, returning either documents or just ids",value:U.SEARCH}],_=[{label:"None",description:"Don't sort anything.",value:k.NONE},{label:"Ascending",description:"Sort the field in Ascending order.",value:k.ASC},{label:"Descending",description:"Sort the values in descending order.",value:k.DESC}];!function(e){e.GET="ts.get",e.INFO="ts.info",e.MGET="ts.mget",e.MRANGE="ts.mrange",e.QUERYINDEX="ts.queryindex",e.RANGE="ts.range"}(W||(W={}));var B,Y,J=[{label:W.GET.toUpperCase(),description:"Returns the last sample",value:W.GET},{label:W.INFO.toUpperCase(),description:"Returns information and statistics on the time-series",value:W.INFO},{label:W.MGET.toUpperCase(),description:"Returns the last samples matching the specific filter",value:W.MGET},{label:W.MRANGE.toUpperCase(),description:"Query a timestamp range across multiple time-series by filters",value:W.MRANGE},{label:W.QUERYINDEX.toUpperCase(),description:"Query all the keys matching the filter list",value:W.QUERYINDEX},{label:W.RANGE.toUpperCase(),description:"Query a range",value:W.RANGE}];!function(e){e.NONE="",e.AVG="avg",e.COUNT="count",e.MAX="max",e.MIN="min",e.RANGE="range",e.SUM="sum",e.FIRST="first",e.LAST="last",e.STDP="std.p",e.STDS="std.s",e.VARP="var.p",e.VARS="var.s"}(B||(B={})),function(e){e.AVG="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e.RANGE="range",e.COUNT="count",e.STDP="std.p",e.STDS="std.s",e.VARP="var.p",e.VARS="var.s"}(Y||(Y={}));var V,X,q=[{label:"None",description:"No aggregation",value:B.NONE},{label:"Avg",description:"Average",value:B.AVG},{label:"Count",description:"Count number of samples",value:B.COUNT},{label:"Max",description:"Maximum",value:B.MAX},{label:"Min",description:"Minimum",value:B.MIN},{label:"Range",description:"Diff between maximum and minimum in the bucket",value:B.RANGE},{label:"Sum",description:"Summation",value:B.SUM},{label:"First",description:"The value with the lowest timestamp in the bucket",value:B.FIRST},{label:"Last",description:"The value with the highest timestamp in the bucket",value:B.LAST},{label:"Std.p",description:"Population standard deviation of the values",value:B.STDP},{label:"Std.s",description:"Sample standard deviation of the values",value:B.STDS},{label:"Var.p",description:"Population variance of the values",value:B.VARP},{label:"Var.s",description:"Sample variance of the values",value:B.VARS}],Q=[{label:"Avg",description:"Arithmetic mean of all non-NaN values",value:Y.AVG},{label:"Sum",description:"Sum of all non-NaN values",value:Y.SUM},{label:"Min",description:"Minimum non-NaN value",value:Y.MIN},{label:"Max",description:"Maximum non-NaN value",value:Y.MAX},{label:"Range",description:"Difference between maximum non-Nan value and minimum non-NaN value",value:Y.RANGE},{label:"Count",description:"Number of non-NaN values",value:Y.COUNT},{label:"Std Population",description:"Population standard deviation of all non-NaN values",value:Y.STDP},{label:"Std Sample",description:"Sample standard deviation of all non-NaN values",value:Y.STDS},{label:"Var Population",description:"Population variance of all non-NaN values",value:Y.VARP},{label:"Var Sample",description:"Sample variance of all non-NaN values",value:Y.VARS}],K=((V={})[O.REDIS]=M,V[O.TIMESERIES]=J,V[O.SEARCH]=j,V[O.GEARS]=w,V[O.GRAPH]=F,V[O.JSON]=L,V),z={aggregation:[W.RANGE,W.MRANGE],field:[P.HGET,P.HMGET],filter:[W.MRANGE,W.QUERYINDEX,W.MGET],keyName:[P.GET,P.HGET,P.HGETALL,P.HKEYS,P.HLEN,P.HMGET,P.LLEN,P.SCARD,P.SMEMBERS,W.RANGE,W.GET,W.INFO,P.TTL,P.TYPE,P.XINFO_STREAM,P.XLEN,U.INFO,U.SEARCH,P.XRANGE,P.XREVRANGE,A.QUERY,A.SLOWLOG,A.EXPLAIN,A.PROFILE,P.ZRANGE,I.TYPE,I.GET,I.OBJKEYS,I.OBJLEN,I.ARRLEN],legend:[W.RANGE],legendLabel:[W.MRANGE,W.MGET],section:[P.INFO],value:[W.RANGE],valueLabel:[W.MRANGE,W.MGET],fill:[W.RANGE,W.MRANGE],size:[P.SLOWLOG_GET,P.TMSCAN],cursor:[P.TMSCAN],match:[P.TMSCAN],count:[P.TMSCAN,P.XRANGE,P.XREVRANGE],samples:[P.TMSCAN],min:[P.ZRANGE],max:[P.ZRANGE],start:[P.XRANGE,P.XREVRANGE],end:[P.XRANGE,P.XREVRANGE],cypher:[A.EXPLAIN,A.QUERY,A.PROFILE],zrangeQuery:[P.ZRANGE],path:[I.TYPE,I.OBJKEYS,I.GET,I.OBJLEN,I.ARRLEN],pyFunction:[b.PYEXECUTE],tsGroupBy:[W.MRANGE],tsReducer:[W.MRANGE],searchQuery:[U.SEARCH],offset:[U.SEARCH],returnFields:[U.SEARCH],limit:[U.SEARCH],sortBy:[U.SEARCH]};!function(e){e.SERVER="server",e.CLIENTS="clients",e.MEMORY="memory",e.PERSISTENCE="persistence",e.STATS="stats",e.REPLICATION="replication",e.CPU="cpu",e.COMMANDSTATS="commandstats",e.CLUSTER="cluster",e.KEYSPACE="keyspace",e.ERRORSTATS="errorstats"}(X||(X={}));var Z,$,ee,te,ne=[{label:"Server",description:"General information about the Redis server",value:X.SERVER},{label:"Clients",description:"Client connections section",value:X.CLIENTS},{label:"Memory",description:"Memory consumption related information",value:X.MEMORY},{label:"Persistence",description:"RDB and AOF related information",value:X.PERSISTENCE},{label:"Stats",description:"General statistics",value:X.STATS},{label:"Replication",description:"Master/replica replication information",value:X.REPLICATION},{label:"CPU",description:"CPU consumption statistics",value:X.CPU},{label:"Command Stats",description:"Command statistics",value:X.COMMANDSTATS},{label:"Cluster",description:"Cluster section",value:X.CLUSTER},{label:"Keyspace",description:"Database related statistics",value:X.KEYSPACE},{label:"Error Stats",description:"Error statistics (Redis 6.2)",value:X.ERRORSTATS}],ae=m.LegacyForms.FormField,re=m.LegacyForms.Switch,ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createNumberFieldHandler=function(e){return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=Number(n.target.value),a)))}},t.createTextFieldHandler=function(e){return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=n.target.value,a)))}},t.createTextareaFieldHandler=function(e){return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=n.target.value,a)))}},t.createSwitchFieldHandler=function(e){return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=n.currentTarget.checked,a)))}},t.createFieldArrayHandler=function(e){return function(n){var a=Number(n.currentTarget.name.split(":",2)[1]);t.props.query[e]||(t.props.query[e]=[]),t.props.query[e][a]=n.currentTarget.value}},t.onKeyNameChange=t.createTextFieldHandler("keyName"),t.onQueryChange=t.createTextareaFieldHandler("query"),t.onSearchQueryChange=t.createTextareaFieldHandler("searchQuery"),t.onFilterChange=t.createTextFieldHandler("filter"),t.onCypherChange=t.createTextareaFieldHandler("cypher"),t.onPathChange=t.createTextareaFieldHandler("path"),t.onFieldChange=t.createTextFieldHandler("field"),t.onLegendChange=t.createTextFieldHandler("legend"),t.onValueChange=t.createTextFieldHandler("value"),t.onSortByChange=t.createTextFieldHandler("sortBy"),t.onCommandChange=t.createSelectFieldHandler("command"),t.onTypeChange=function(e){var n=t.props,a=n.onChange,r=n.query;a(o(o({},r),{type:e.value,query:"",command:""}))},t.onTsReducerChange=t.createSelectFieldHandler("tsReducer"),t.onTsGroupByLabelChange=t.createTextFieldHandler("tsGroupByLabel"),t.onAggregationChange=t.createSelectFieldHandler("aggregation"),t.onZRangeQueryChange=t.createSelectFieldHandler("zrangeQuery"),t.onSortDirectionChange=t.createSelectFieldHandler("sortDirection"),t.onInfoSectionChange=t.createSelectFieldHandler("section"),t.onBucketChange=t.createNumberFieldHandler("bucket"),t.onSizeChange=t.createNumberFieldHandler("size"),t.onCountChange=t.createNumberFieldHandler("count"),t.onOffsetChange=t.createNumberFieldHandler("offset"),t.onSamplesChange=t.createNumberFieldHandler("samples"),t.onCursorChange=t.createTextFieldHandler("cursor"),t.onMatchChange=t.createTextFieldHandler("match"),t.onStartChange=t.createTextFieldHandler("start"),t.onEndChange=t.createTextFieldHandler("end"),t.onMinChange=t.createTextFieldHandler("min"),t.onMaxChange=t.createTextFieldHandler("max"),t.onFillChange=t.createSwitchFieldHandler("fill"),t.onStreamingChange=t.createSwitchFieldHandler("streaming"),t.onStreamingIntervalChange=t.createNumberFieldHandler("streamingInterval"),t.onStreamingCapacityChange=t.createNumberFieldHandler("streamingCapacity"),t.onStreamingDataTypeChange=t.createRedioButtonFieldHandler("streamingDataType"),t.onReturnFieldChange=t.createFieldArrayHandler("returnFields"),t}return i(t,e),t.prototype.createSelectFieldHandler=function(e){var t=this;return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=n.value,a)))}},t.prototype.createRedioButtonFieldHandler=function(e){var t=this;return function(n){var a;t.props.onChange(o(o({},t.props.query),((a={})[e]=n,a)))}},t.prototype.render=function(){var e,t=this,n=this.props.query,a=n.keyName,r=n.aggregation,i=n.zrangeQuery,o=n.bucket,l=n.legend,s=n.command,p=n.field,h=n.filter,g=n.cypher,b=n.path,y=n.value,C=n.query,S=n.searchQuery,N=n.offset,A=n.sortDirection,w=n.sortBy,I=n.type,F=n.section,L=n.size,P=n.fill,G=n.cursor,M=n.count,U=n.match,W=n.samples,j=n.start,B=n.end,Y=n.min,J=n.max,V=n.streaming,X=n.streamingInterval,ie=n.streamingCapacity,oe=n.streamingDataType,le=n.tsGroupByLabel,se=n.tsReducer,ce=this.props,ue=ce.onRunQuery,de=ce.datasource,pe=null===(e=Object(R.getDataSourceSrv)().getInstanceSettings(de.uid))||void 0===e?void 0:e.jsonData,he=null==pe?void 0:pe.cliDisabled;return f.a.createElement("div",null,f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8},"Type"),f.a.createElement(m.Select,{className:Object(T.css)(Z||(Z=d(["\n              margin-right: 5px;\n            "],["\n              margin-right: 5px;\n            "]))),width:40,options:he?x:u(u([],c(x),!1),[D],!1),menuPlacement:"bottom",value:I,onChange:this.onTypeChange}),I===O.CLI&&f.a.createElement(f.a.Fragment,null,f.a.createElement(m.InlineFormLabel,{width:8},"Command"),f.a.createElement(m.TextArea,{value:C,className:"gf-form-input",onChange:this.onQueryChange})),I&&I!==O.CLI&&f.a.createElement(f.a.Fragment,null,f.a.createElement(m.InlineFormLabel,{width:8},"Command"),f.a.createElement(m.Select,{options:K[I],menuPlacement:"bottom",value:s,onChange:this.onCommandChange}))),I!==O.CLI&&s&&f.a.createElement("div",{className:"gf-form"},z.keyName.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:30,value:a,onChange:this.onKeyNameChange,label:"Key",tooltip:"Key name"}),z.filter.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:30,value:h,onChange:this.onFilterChange,label:"Label Filter",tooltip:"Whenever filters need to be provided, a minimum of one l=v filter must be applied.\n                The list of possible filters:\n                https://oss.redislabs.com/redistimeseries/commands/#filtering"}),z.field.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:30,value:p,onChange:this.onFieldChange,label:"Field"}),z.legend.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:20,value:l,onChange:this.onLegendChange,label:"Legend",tooltip:"Legend override"}),z.value.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:y,onChange:this.onValueChange,label:"Value",tooltip:"Value override"}),z.legendLabel.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:l,onChange:this.onLegendChange,label:"Legend Label"}),z.valueLabel.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:y,onChange:this.onValueChange,label:"Value Label"}),z.size.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:L,type:"number",onChange:this.onSizeChange,label:"Size"}),z.cursor.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:G,onChange:this.onCursorChange,label:"Cursor"}),z.match.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:U,onChange:this.onMatchChange,placeholder:"*",label:"Match pattern"})),s&&z.cypher.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{tooltip:"The syntax is based on Cypher, and only a subset of the language currently supported: \\\n                https://oss.redislabs.com/redisgraph/commands/#query-language",width:8},"Cypher"),f.a.createElement(m.TextArea,{value:g,className:"gf-form-input",onChange:this.onCypherChange})),s&&z.pyFunction.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(ae,{labelWidth:8,inputWidth:30,value:a,onChange:this.onKeyNameChange,label:"Function"})),s&&z.path.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{tooltip:"RedisJSON's syntax is a subset of common best practices and resembles JSONPath not by accident.",width:8},"Path"),f.a.createElement(m.TextArea,{value:b,className:"gf-form-input",onChange:this.onPathChange})),s&&z.searchQuery.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{tooltip:"The RediSearch Query to issue to the index.",width:10},"Query"),f.a.createElement(m.TextArea,{value:S,className:"gf-form-input",onChange:this.onSearchQueryChange})),s&&z.returnFields.includes(s)&&f.a.createElement(m.Form,{id:"returnFieldsForm",onSubmit:function(){return!0},defaultValues:{fieldArray:[""]}},(function(e){var n=e.control;return f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{tooltip:"Add return Fields to query to minimize what needs to be pulled back from Redis.",width:10},"Return Fields"),f.a.createElement(m.FieldArray,{name:"returnFields",control:n},(function(e){var n=e.fields,a=e.append;return f.a.createElement(f.a.Fragment,null,f.a.createElement(m.Button,{id:"addReturnFieldButton",onClick:function(){return a({})}},"Add Return Field"),f.a.createElement("div",{id:"returnFieldInputs"},n.map((function(e,n){return f.a.createElement(m.Input,{name:"returnField:"+n,key:e.id,onChange:t.onReturnFieldChange})}))))})))})),s&&z.offset.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:N,type:"number",onChange:this.onOffsetChange,label:"Offset",defaultValue:"0"}),s&&z.limit.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:M,type:"number",onChange:this.onCountChange,label:"Limit",defaultValue:"10"}),s&&z.sortBy.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8},"Sort Direction"),f.a.createElement(m.Select,{onChange:this.onSortDirectionChange,options:_,width:20,value:A,defaultValue:k.NONE}),A&&A!==k.NONE&&f.a.createElement("div",null,f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:w,onChange:this.onSortByChange,type:"string",label:"Sort By"}))),I===O.REDIS&&s&&z.zrangeQuery.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8},"Range Query"),f.a.createElement(m.Select,{className:Object(T.css)($||($=d(["\n                margin-right: 5px;\n              "],["\n                margin-right: 5px;\n              "]))),options:H,width:30,onChange:this.onZRangeQueryChange,value:i,menuPlacement:"bottom"})),I!==O.CLI&&s&&f.a.createElement("div",{className:"gf-form"},z.start.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:j,onChange:this.onStartChange,placeholder:"time range",label:"Start",tooltip:"Based on the selected time range, if not specified"}),z.end.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:B,onChange:this.onEndChange,placeholder:"time range",label:"End",tooltip:"Based on the selected time range, if not specified"}),z.min.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:Y,onChange:this.onMinChange,label:"Minimum"}),z.max.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:J,onChange:this.onMaxChange,label:"Maximum"}),z.count.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:M,type:"number",onChange:this.onCountChange,label:"Count"}),z.samples.includes(s)&&f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:W,type:"number",onChange:this.onSamplesChange,label:"Samples",placeholder:"5",tooltip:"Number of sampled nested values. 0 (all values) is not supported."})),I===O.REDIS&&s&&z.section.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8},"Section"),f.a.createElement(m.Select,{options:ne,onChange:this.onInfoSectionChange,value:F,menuPlacement:"bottom"})),I===O.TIMESERIES&&s&&z.aggregation.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8},"Aggregation"),f.a.createElement(m.Select,{className:Object(T.css)(ee||(ee=d(["\n                  margin-right: 5px;\n                "],["\n                  margin-right: 5px;\n                "]))),options:q,width:30,onChange:this.onAggregationChange,value:r,menuPlacement:"bottom"}),r&&f.a.createElement(ae,{labelWidth:8,value:o,type:"number",onChange:this.onBucketChange,label:"Time Bucket",tooltip:"Time bucket for aggregation in milliseconds"}),r&&o&&z.fill.includes(s)&&f.a.createElement(re,{label:"Fill Missing",labelClass:"width-10",tooltip:"If checked, the datasource will fill missing intervals.",checked:P||!1,onChange:this.onFillChange})),I===O.TIMESERIES&&s&&z.tsGroupBy.includes(s)&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(ae,{labelWidth:8,inputWidth:10,value:le,onChange:this.onTsGroupByLabelChange,label:"Group By",tooltip:"The label to group your time-series by for your reduction"}),le&&f.a.createElement(m.Select,{options:Q,width:30,onChange:this.onTsReducerChange,value:se,menuPlacement:"bottom"})),f.a.createElement("div",{className:"gf-form"},f.a.createElement(re,{label:"Streaming",labelClass:"width-8",tooltip:"If checked, the datasource will stream data.",checked:V||!1,onChange:this.onStreamingChange}),V&&f.a.createElement(f.a.Fragment,null,f.a.createElement(ae,{labelWidth:8,value:X,type:"number",onChange:this.onStreamingIntervalChange,label:"Interval",tooltip:"Streaming interval in milliseconds. Default is 1000ms. For multiple Streaming targets minimum value will be taken.",placeholder:"1000"}),f.a.createElement(ae,{labelWidth:8,value:ie,type:"number",onChange:this.onStreamingCapacityChange,label:"Capacity",tooltip:"Values will be constantly added and will never exceed the given capacity. Default is 1000.",placeholder:"1000"}))),V&&f.a.createElement("div",{className:"gf-form"},f.a.createElement(m.InlineFormLabel,{width:8,tooltip:"If checked Time series, the last line of data will be applied."},"Data type"),f.a.createElement(m.RadioButtonGroup,{options:E,value:oe||v.TIMESERIES,onChange:this.onStreamingDataTypeChange}),oe!==v.DATAFRAME&&f.a.createElement(ae,{className:Object(T.css)(te||(te=d(["\n                  margin-left: 5px;\n                "],["\n                  margin-left: 5px;\n                "]))),labelWidth:8,inputWidth:30,value:p,tooltip:"Specify field(s) to return from backend. Required for Alerting to trigger on specific fields.",onChange:this.onFieldChange,label:"Filter Field"})),f.a.createElement(m.Button,{onClick:ue},"Run"))},t}(h.PureComponent),oe=n(5),le=function(e,t){return(le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}le(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function ce(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{s(a.next(e))}catch(e){i(e)}}function l(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}s((a=a.apply(e,t||[])).next())}))}function ue(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}Object.create;function de(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function pe(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}function he(e,t){for(var n=0,a=t.length,r=e.length;n<a;n++,r++)e[r]=t[n];return e}function fe(e){return this instanceof fe?(this.v=e,this):new fe(e)}function me(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,r=n.apply(e,t||[]),i=[];return a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a;function o(e){r[e]&&(a[e]=function(t){return new Promise((function(n,a){i.push([e,t,n,a])>1||l(e,t)}))})}function l(e,t){try{(n=r[e](t)).value instanceof fe?Promise.resolve(n.value.v).then(s,c):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function s(e){l("next",e)}function c(e){l("throw",e)}function u(e,t){e(t),i.shift(),i.length&&l(i[0][0],i[0][1])}}function ve(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=de(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(n){t[n]=e[n]&&function(t){return new Promise((function(a,r){(function(e,t,n,a){Promise.resolve(a).then((function(t){e({value:t,done:n})}),t)})(a,r,(t=e[n](t)).done,t.value)}))}}}Object.create;var ge=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function be(e){return"function"==typeof e}function Ee(e){return be(null==e?void 0:e.then)}var ye="function"==typeof Symbol&&Symbol.observable||"@@observable";var Ce,Se=((Ce=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),Ce.prototype.constructor=Ce,Ce);function Ne(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Te=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,a,r;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var o=de(i),l=o.next();!l.done;l=o.next()){l.value.remove(this)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else i.remove(this);var s=this.initialTeardown;if(be(s))try{s()}catch(e){r=e instanceof Se?e.errors:[e]}var c=this._teardowns;if(c){this._teardowns=null;try{for(var u=de(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{Ae(p)}catch(e){r=null!=r?r:[],e instanceof Se?r=he(he([],pe(r)),pe(e.errors)):r.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}}if(r)throw new Se(r)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Ae(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Ne(t,e)},e.prototype.remove=function(t){var n=this._teardowns;n&&Ne(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();Te.EMPTY;function Re(e){return e instanceof Te||e&&"closed"in e&&be(e.remove)&&be(e.add)&&be(e.unsubscribe)}function Ae(e){be(e)?e():e.unsubscribe()}var we={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ie={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Ie.delegate;return((null==n?void 0:n.setTimeout)||setTimeout).apply(void 0,he([],pe(e)))},clearTimeout:function(e){var t=Ie.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Fe(e){Ie.setTimeout((function(){var t=we.onUnhandledError;if(!t)throw e;t(e)}))}function Oe(){}var Le=Pe("C",void 0,void 0);function Pe(e,t,n){return{kind:e,value:t,error:n}}var xe=null;function De(e){we.useDeprecatedSynchronousErrorHandling&&xe&&(xe.errorThrown=!0,xe.error=e)}var Ge=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Re(t)&&t.add(n)):n.destination=We,n}return se(t,e),t.create=function(e,t,n){return new Me(e,t,n)},t.prototype.next=function(e){this.isStopped?He(function(e){return Pe("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?He(Pe("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?He(Le,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Te),Me=function(e){function t(t,n,a){var r,i=e.call(this)||this;if(be(t))r=t;else if(t){var o;r=t.next,n=t.error,a=t.complete,i&&we.useDeprecatedNextContext?(o=Object.create(t)).unsubscribe=function(){return i.unsubscribe()}:o=t,r=null==r?void 0:r.bind(o),n=null==n?void 0:n.bind(o),a=null==a?void 0:a.bind(o)}return i.destination={next:r?Ue(r,i):Oe,error:Ue(null!=n?n:ke,i),complete:a?Ue(a,i):Oe},i}return se(t,e),t}(Ge);function Ue(e,t){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{e.apply(void 0,he([],pe(t)))}catch(e){we.useDeprecatedSynchronousErrorHandling?De(e):Fe(e)}}}function ke(e){throw e}function He(e,t){var n=we.onStoppedNotification;n&&Ie.setTimeout((function(){return n(e,t)}))}var We={closed:!0,next:Oe,error:ke,complete:Oe};function je(e){return e}function _e(e){return 0===e.length?je:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Be=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var a,r=this,i=(a=e)&&a instanceof Ge||function(e){return e&&be(e.next)&&be(e.error)&&be(e.complete)}(a)&&Re(a)?e:new Me(e,t,n);return function(e){if(we.useDeprecatedSynchronousErrorHandling){var t=!xe;if(t&&(xe={errorThrown:!1,error:null}),e(),t){var n=xe,a=n.errorThrown,r=n.error;if(xe=null,a)throw r}}else e()}((function(){var e=r,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?r._subscribe(i):r._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Ye(t))((function(t,a){var r;r=n.subscribe((function(t){try{e(t)}catch(e){a(e),null==r||r.unsubscribe()}}),a,t)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ye]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return _e(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Ye(e))((function(e,n){var a;t.subscribe((function(e){return a=e}),(function(e){return n(e)}),(function(){return e(a)}))}))},e.create=function(t){return new e(t)},e}();function Ye(e){var t;return null!==(t=null!=e?e:we.Promise)&&void 0!==t?t:Promise}var Je="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Ve(e){return be(e[ye])}function Xe(e){return be(null==e?void 0:e[Je])}function qe(e){return Symbol.asyncIterator&&be(null==e?void 0:e[Symbol.asyncIterator])}function Qe(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ke(e){return me(this,arguments,(function(){var t,n,a;return ue(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,fe(t.read())];case 3:return n=r.sent(),a=n.value,n.done?[4,fe(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,fe(a)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function ze(e){return be(null==e?void 0:e.getReader)}function Ze(e){if(e instanceof Be)return e;if(null!=e){if(Ve(e))return r=e,new Be((function(e){var t=r[ye]();if(be(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(ge(e))return a=e,new Be((function(e){for(var t=0;t<a.length&&!e.closed;t++)e.next(a[t]);e.complete()}));if(Ee(e))return n=e,new Be((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,Fe)}));if(qe(e))return $e(e);if(Xe(e))return t=e,new Be((function(e){var n,a;try{for(var r=de(t),i=r.next();!i.done;i=r.next()){var o=i.value;if(e.next(o),e.closed)return}}catch(e){n={error:e}}finally{try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(n)throw n.error}}e.complete()}));if(ze(e))return $e(Ke(e))}var t,n,a,r;throw Qe(e)}function $e(e){return new Be((function(t){(function(e,t){var n,a,r,i;return ce(this,void 0,void 0,(function(){var o,l;return ue(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),n=ve(e),s.label=1;case 1:return[4,n.next()];case 2:if((a=s.sent()).done)return[3,4];if(o=a.value,t.next(o),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=s.sent(),r={error:l},[3,11];case 6:return s.trys.push([6,,9,10]),a&&!a.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function et(e){return function(t){if(function(e){return be(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var tt=function(e){function t(t,n,a,r,i){var o=e.call(this,t)||this;return o.onFinalize=i,o._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,o._error=r?function(e){try{r(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=a?function(){try{a()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return se(t,e),t.prototype.unsubscribe=function(){var t,n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))},t}(Ge);function nt(e,t){return et((function(n,a){var r=null,i=0,o=!1,l=function(){return o&&!r&&a.complete()};n.subscribe(new tt(a,(function(n){null==r||r.unsubscribe();var o=0,s=i++;Ze(e(n,s)).subscribe(r=new tt(a,(function(e){return a.next(t?t(n,e,s,o++):e)}),(function(){r=null,l()})))}),(function(){o=!0,l()})))}))}var at=function(){function e(e){this.frame=new a.CircularDataFrame({append:"tail",capacity:(null==e?void 0:e.streamingCapacity)||1e3}),this.frame.refId=null==e?void 0:e.refId}return e.prototype.update=function(e){return l(this,void 0,Promise,(function(){var t,n=this;return s(this,(function(r){return t={},e.forEach((function(e){var r=e.values.toArray(),i=r[r.length-1];n.frame.fields.some((function(t){return t.name===e.name}))||n.frame.addField({name:e.name,type:e.type!==a.FieldType.string||isNaN(i)?e.type:a.FieldType.number}),t[e.name]=i})),this.frame.add(t),[2,Promise.resolve(this.frame)]}))}))},e}(),rt=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.metricFindQuery=function(e,t){return l(this,void 0,Promise,(function(){return s(this,(function(n){return e?[2,Object(oe.lastValueFrom)(this.query({targets:[{refId:"A",datasource:t.variable.datasource,query:e}]}).pipe(nt((function(e){return e.data})),nt((function(e){return e.fields})),(a=function(e){var t=[];return e.values.toArray().forEach((function(e){t.push({text:e})})),t},et((function(e,t){var n=0;e.subscribe(new tt(t,(function(e){t.next(a.call(r,e,n++))})))})))))]:[2,Promise.resolve([])];var a,r}))}))},t.prototype.applyTemplateVariables=function(e,t){var n=Object(R.getTemplateSrv)();return o(o({},e),{keyName:e.keyName?n.replace(e.keyName,t):"",query:e.query?n.replace(e.query,t):"",field:e.field?n.replace(e.field,t):"",filter:e.filter?n.replace(e.filter,t):"",legend:e.legend?n.replace(e.legend,t):"",value:e.value?n.replace(e.value,t):"",path:e.path?n.replace(e.path,t):"",cypher:e.cypher?n.replace(e.cypher,t):""})},t.prototype.query=function(t){var n=this;return t.targets.length&&t.targets.filter((function(e){return e.streaming})).length?new oe.Observable((function(r){var i={};t.targets.forEach((function(e){e.streamingDataType!==v.DATAFRAME&&(i[e.refId]=new at(e))}));var o=t.targets.map((function(e){return e.streamingInterval?e.streamingInterval:1e3})),d=setInterval((function(){return l(n,void 0,void 0,(function(){var n=this;return s(this,(function(o){switch(o.label){case 0:return[4,Object(oe.lastValueFrom)(e.prototype.query.call(this,t))];case 1:return o.sent().data.forEach((function(e){return l(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return i[e.refId]?[4,i[e.refId].update(e.fields)]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return r.next({data:[e],key:e.refId,state:a.LoadingState.Streaming}),[2]}}))}))})),[2]}}))}))}),Math.min.apply(Math,u([],c(o),!1)));return function(){clearInterval(d)}})):e.prototype.query.call(this,t)},t}(R.DataSourceWithBackend);n.d(t,"plugin",(function(){return it}));var it=new a.DataSourcePlugin(rt).setConfigEditor(N).setQueryEditor(ie)}])}));
//# sourceMappingURL=module.js.map